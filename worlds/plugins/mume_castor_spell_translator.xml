<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- This Source Code Form is subject to the terms of the Mozilla Public -->
<!-- License, v. 2.0. If a copy of the MPL was not distributed with this -->
<!-- file, You can obtain one at http://mozilla.org/MPL/2.0/. -->

<!-- Saved on Saturday, August 18, 2012, 3:39 PM -->
<!-- MuClient version 4.81 -->

<!-- Plugin "mume_castor_spell_translator" generated by Plugin Wizard -->

<muclient>
<plugin
   name="mume_castor_spell_translator"
   author="Nick Stockton"
   id="8b4e5dd676d8477dc5f14376"
   language="Lua"
   purpose="Translates a castor's incantation in to a valid spell name."
   date_written="2012-08-18 15:38:24"
   requires="4.70"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?P&lt;castor&gt;[^\']+?) utters the word[s]? \'(?P&lt;spell&gt;[a-z ]+)\'$"
   name="translate_spell"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>note_interrupt(string.format("%s casts %s!", "%&lt;castor&gt;", SPELLS["%&lt;spell&gt;"] or "%&lt;spell&gt;"))</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?P&lt;castor&gt;[^\.]+?) begins some strange incantations\.\.\.$"
   name="shorten_casting_message"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>note_interrupt("%&lt;castor&gt; casting!")</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^As you call upon Elbereth\, (?P&lt;target&gt;[^\.]+?) shivers in pain\.$"
   name="shorten_dispel_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Dispelled %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="You raise your hand and an icy wind starts to blow through the room."
   name="shorten_fear_message"
   omit_from_output="y"
   send_to="2"
   sequence="100"
  >
  <send>Feared!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^You spray (?P&lt;target&gt;[^\.]+?) with many\-coloured rays of bright light\.$"
   name="shorten_colour_spray_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Sprayed %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^You burn (?P&lt;target&gt;[^\.]+)\.$"
   name="shorten_burning_hands_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Burned %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^Your fireball completely envelops (?P&lt;target&gt;[^\.]+?) in flames\.$"
   name="shorten_fireball_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Fireballed %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^The lightning bolt hits (?P&lt;target&gt;[^\.]+?) with full impact\.$"
   name="shorten_lightning_bolt_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Bolted %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="The earth trembles beneath your feet!"
   name="shorten_earth_quake_message"
   omit_from_output="y"
   send_to="2"
   sequence="100"
  >
  <send>Quake!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?P&lt;target&gt;[^\.]+?) lies down and falls asleep\.$"
   name="shorten_sleeping_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Sleeping %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?P&lt;target&gt;[^\!]+?) (?:seems to be blinded\!|shivers as some of \w+ eyes become glazed\.)$"
   name="shorten_blinded_message"
   omit_from_output="y"
   regexp="y"
   send_to="2"
   sequence="100"
  >
  <send>Blinded %&lt;target&gt;!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="Your victim is already blind."
   name="already_blinded_message"
   omit_from_output="y"
   regexp="n"
   send_to="2"
   sequence="100"
  >
  <send>Already blinded!</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="Argh! You cannot concentrate any more..."
   name="casting_interrupted"
   omit_from_output="y"
   regexp="n"
   send_to="14"
   sequence="100"
  >
  <send>note_interrupt("Interrupted!")</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?:Nothing seems to happen\.|The cruel light of the sun made you lose your concentration\!)$"
   name="shorten_fail_message"
   omit_from_output="y"
   regexp="y"
   send_to="14"
   sequence="100"
  >
  <send>note_interrupt("Nothing happens!")</send>
  </trigger>
</triggers>

<!--  Script  -->


<script>
<![CDATA[
TTS = "925cdd0331023d9f0b8f05a7"
CONFIG = "d19a2f0a604c96b7318aa67f"

SPELLS = {
	["abrawajf"] = "armour",
	["bfzahp ay bfugtizgg"] = "breath of briskness",
	["bfzat eaaf"] = "break door",
	["aque bfzahp"] = "acid breath",
	["braqt bfzahp"] = "black breath",
	["braqt eaaf"] = "block door",
	["qarr yawuruabra"] = "call familiar",
	["canduswazz judifgz"] = "remove curse",
	["canduswazz saugai"] = "remove poison",
	["diesilla barh"] = "lightning bolt",
	["eabratizgg"] = "darkness",
	["eugszr waouq"] = "dispel magic",
	["eugszr zzur"] = "dispel evil",
	["nazsh"] = "destroy",
	["euzuiahuai"] = "divination",
	["fido"] = "bless",
	["gaiqhjabral"] = "sanctuary",
	["ghafz"] = "store",
	["ghcandusiohp"] = "strength",
	["gjwwai"] = "summon",
	["bzzack"] = "summon assistant",
	["gpaqtuio ofags"] = "shocking grasp",
	["gpfaje"] = "shroud",
	["gpuzre"] = "shield",
	["gqfl"] = "scry",
	["gruugz oculoae"] = "raise dead",
	["grzzs"] = "sleep",
	["gunsogz ruyz"] = "sense life",
	["gurunsoqz"] = "silence",
	["hgruigyzf"] = "transfer",
	["hiqahz"] = "locate",
	["hiqahz ruyz"] = "locate life",
	["hiqahz waouq"] = "locate magic",
	["hzrzsafh"] = "teleport",
	["iuoph zuguai"] = "night vision",
	["judicandus dies"] = "cure light",
	["judicandus eugzagz"] = "cure disease",
	["judicandus gzfuajg"] = "cure serious",
	["judicandus noselacri"] = "cure blindness",
	["judicandus qfuhuq"] = "cure critic",
	["judifgz"] = "curse",
	["mosailla paieg"] = "BURNING HANDS",
	["noselacri"] = "blindness",
	["oculoinfra saugai"] = "detect poison",
	["oculoinfra uizuguburuhl"] = "detect invisibility",
	["oculoinfra waouq"] = "detect magic",
	["oculoinfra zzur"] = "detect evil",
	["pabraw"] = "harm",
	["pare"] = "hold",
	["pzar"] = "heal",
	["qahijf gsfal"] = "colour spray",
	["qaihfar xzahpzf"] = "control weather",
	["qarr diesilla"] = "call lightning",
	["qfzahz dies"] = "create light",
	["qfzahz xahzf"] = "create water",
	["qfzahz yaae"] = "create food",
	["qpabraw"] = "charm",
	["qpurr hajqp"] = "chill touch",
	["safhar"] = "portal",
	["saugai"] = "poison",
	["sfahzqhuai yfaw zzur"] = "protection from evil",
	["unsoqpaih"] = "enchant",
	["unsozfol efaui"] = "energy drain",
	["Ankalachbeth"] = "mana drain",
	["uoculoihuyl"] = "identify",
	["waouq bragh"] = "magic blast",
	["waouq wuggurz"] = "magic missile",
	["xafe ay candusqarr"] = "word of recall",
	["xahqp faaw"] = "watch room",
	["yufzbarr"] = "fireball",
	["yuie hpz sahp"] = "find the path",
	["yzabra"] = "fear",
	["zabrahpdjatz"] = "earthquake",
	["gwahpzf"] = "smother",
}

return_code, casting_interrupt = CallPlugin(CONFIG, "get", "casting_interrupt")

function toggle_casting_interrupt()
	casting_interrupt = not casting_interrupt
	CallPlugin(CONFIG, "set", "casting_interrupt", casting_interrupt)
	CallPlugin(TTS, "say", string.format("Speech interrupt for spell casting %s.", casting_interrupt and "on" or "off"), true)
end

function note_interrupt(message)
	if casting_interrupt then
		CallPlugin(TTS, "silence")
	end
	Note(message)
end

]]>
</script>


</muclient>
