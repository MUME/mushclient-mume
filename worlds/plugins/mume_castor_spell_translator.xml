<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE muclient>
<!-- This Source Code Form is subject to the terms of the Mozilla Public -->
<!-- License, v. 2.0. If a copy of the MPL was not distributed with this -->
<!-- file, You can obtain one at http://mozilla.org/MPL/2.0/. -->

<!-- Saved on Saturday, August 18, 2012, 3:39 PM -->
<!-- MuClient version 4.81 -->

<!-- Plugin "mume_castor_spell_translator" generated by Plugin Wizard -->

<muclient>
<plugin
   name="mume_castor_spell_translator"
   author="Nick Stockton"
   id="8b4e5dd676d8477dc5f14376"
   language="Lua"
   purpose="Translates a castor's incantation in to a valid spell name."
   date_written="2012-08-18 15:38:24"
   requires="4.70"
   version="1.0"
   >

</plugin>


<!--  Get our standard constants -->

<include name="constants.lua"/>

<!--  Triggers  -->

<triggers>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?:ENEMY:)?(?P&lt;castor&gt;.+?)(?::ENEMY)? utters the word[s]? \'(?P&lt;spell&gt;[a-z ]+)\'$"
   name="translate_spell"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>translate("%&lt;castor&gt;", "%&lt;spell&gt;")</send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?:ENEMY:)?(?P&lt;castor&gt;.+?)(?::ENEMY)? begins some strange incantations\.\.\.$"
   name="shorten_casting_message"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>	CallPlugin(screenReader, "sayNote", "%&lt;castor&gt; is casting!", casting_interrupt == true)
  </send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^(?:ENEMY:)?(?P&lt;target&gt;.+?)(?::ENEMY)? seems to be blinded\!$"
   name="shorten_blinded_message"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>	CallPlugin(screenReader, "sayNote", "blinded %&lt;target&gt;!", casting_interrupt == true)
  </send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^Your victim is already blind\.$"
   name="already_blinded_message"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>	CallPlugin(screenReader, "sayNote", "Already blinded!", casting_interrupt == true)
  </send>
  </trigger>
  <trigger
   enabled="y"
   group="mume_castor_spell_translator"
   match="^Nothing seems to happen\.$"
   name="shorten_fail_message"
   omit_from_output="y"
   regexp="y"
   send_to="12"
   sequence="100"
  >
  <send>	CallPlugin(screenReader, "sayNote", "Nothing happens!", casting_interrupt == true)
  </send>
  </trigger>
</triggers>

<!--  Script  -->


<script>
<![CDATA[
screenReader = "925cdd0331023d9f0b8f05a7"
config = "d19a2f0a604c96b7318aa67f"
return_code, casting_interrupt = CallPlugin(config, "get", "casting_interrupt")

spells = {
	["abrawajf"] = "armour",
	["bfzahp ay bfugtizgg"] = "breath of briskness",
	["bfzat eaaf"] = "break door",
	["braqt bfzahp"] = "black breath",
	["braqt eaaf"] = "block door",
	["qarr yawuruabra"] = "call familiar",
	["canduswazz judifgz"] = "remove curse",
	["canduswazz saugai"] = "remove poison",
	["diesilla barh"] = "LIGHTNING BOLT",
	["eabratizgg"] = "darkness",
	["eugszr waouq"] = "dispel magic",
	["eugszr zzur"] = "DISPEL EVIL",
	["euzuiahuai"] = "divination",
	["fido"] = "bless",
	["gaiqhjabral"] = "sanctuary",
	["ghafz"] = "store",
	["ghcandusiohp"] = "strength",
	["gjwwai"] = "summon",
	["gpaqtuio ofags"] = "SHOCKING GRASP",
	["gpfaje"] = "shroud",
	["gpuzre"] = "shield",
	["gqfl"] = "scry",
	["gruugz oculoae"] = "raise dead",
	["grzzs"] = "sleep",
	["gunsogz ruyz"] = "sense life",
	["gurunsoqz"] = "silence",
	["hgruigyzf"] = "transfer",
	["hiqahz"] = "locate",
	["hiqahz ruyz"] = "locate life",
	["hiqahz waouq"] = "locate magic",
	["hzrzsafh"] = "teleport",
	["iuoph zuguai"] = "night vision",
	["judicandus dies"] = "cure light",
	["judicandus gzfuajg"] = "cure serious",
	["judicandus noselacri"] = "cure blindness",
	["judicandus qfuhuq"] = "cure critic",
	["judifgz"] = "curse",
	["mosailla paieg"] = "BURNING HANDS",
	["noselacri"] = "blindness",
	["oculoinfra saugai"] = "detect poison",
	["oculoinfra uizuguburuhl"] = "detect invisibility",
	["oculoinfra waouq"] = "detect magic",
	["oculoinfra zzur"] = "detect evil",
	["pabraw"] = "HARM",
	["pare"] = "hold",
	["pzar"] = "heal",
	["qahijf gsfal"] = "COLOUR SPRAY",
	["qaihfar xzahpzf"] = "control weather",
	["qarr diesilla"] = "CALL LIGHTNING",
	["qfzahz dies"] = "create light",
	["qfzahz xahzf"] = "create water",
	["qfzahz yaae"] = "create food",
	["qpabraw"] = "charm",
	["qpurr hajqp"] = "CHILL TOUCH",
	["safhar"] = "\033[1m\033[37m!PORTAL!\033[0m",
	["saugai"] = "poison",
	["sfahzqhuai yfaw zzur"] = "protection from evil",
	["unsoqpaih"] = "enchant",
	["unsozfol efaui"] = "energy drain",
	["uoculoihuyl"] = "identify",
	["waouq bragh"] = "magic blast",
	["waouq wuggurz"] = "MAGIC MISSILE",
	["xafe ay candusqarr"] = "word of recall",
	["xahqp faaw"] = "watch room",
	["yufzbarr"] = "FIREBALL",
	["yuie hpz sahp"] = "find the path",
	["yzabra"] = "fear",
	["zabrahpdjatz"] = "EARTHQUAKE",
}

function translate(castor, spell)
	if spells[spell] then
		spell = spells[spell]
	end
	local line = string.format("%s casts %s!", castor, spell)
	CallPlugin(screenReader, "sayNote", line, casting_interrupt == true)
end

function toggle_casting_interrupt()
	casting_interrupt = not casting_interrupt
	CallPlugin(config, "set", "casting_interrupt", casting_interrupt)
	CallPlugin(screenReader, "say", string.format("Speech interrupt for spell casting %s.", casting_interrupt and "on" or "off"), true)
end

]]>
</script>


</muclient>
